---
title: ""
author: "Anita Hessami Pilehrood, Isabelle Liu, Christian Hardat"
subtitle: "STA302 - Fall 2023 - Project"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
---


Introduction section:

Methods section:

```{r}
library(readxl)
Dataset <- read.csv("/Users/christianhardat/Downloads/STA302 Part 1 Cleaned Dataset.csv")
  
summary(Dataset)

new <- subset(as.data.frame(Dataset), 
              select = c(Thinness, Hepatitis_B, Measles, 
                         Healthcare_Expenditure, Status_name, Schooling))

new_clean <- new[complete.cases(new),]
dim(new_clean)


# Convert categorical variables to factors
new_clean$Status_name <- as.factor(new_clean$Status_name)

# Create dummy variables for categorical predictors
new_clean <- model.matrix(~ . - 1, data = new_clean)
new_clean <- data.frame(new_clean)

summary(new_clean)

model1 <- lm(Thinness ~ Hepatitis_B + Measles + Healthcare_Expenditure + Status_name + Schooling, data = new_clean)
model1

y_hat <- fitted(model1)
e_hat <- resid(model1)
plot(x = y_hat, y = e_hat, main="Residual vs Fitted", xlab="Fitted",
     ylab="Residuals")
plot(e_hat ~ new_clean$Hepatitis_B, main="Residuals vs Hepatitis B", xlab="Hepatitis B", ylab="Residual")
plot(e_hat ~ new_clean$Measles, main="Residuals vs Measles", xlab="Measles", ylab="Residual")
plot(e_hat ~ new_clean$Healthcare_Expenditure, main="Residuals vs Healthcare Expenditure", xlab="Healthcare Expenditure", ylab="Residual")
boxplot(e_hat ~ new_clean$Status_name, main="Residuals vs Status Name", xlab="Status Name", ylab="Residual")
plot(e_hat ~ new_clean$Schooling, main="Residuals vs Schooling", xlab="Schooling", ylab="Residual")
qqnorm(e_hat)
qqline(e_hat)
plot(x = y_hat, y = model1$Thinness, main="Response vs Fitted",
     xlab="Fitted", ylab="Thinness")
abline(a = 0, b = 1, lty=2)
hist(new_clean$Thinness, main="Histogram", xlab="Thinness")

#install.packages("car")
library(car)

boxCox(model1)

any(Dataset$Measles <= 0)
constant_value <- 0.0001
Dataset$adjMeasles <- Dataset$Measles + constant_value
p <- powerTransform(Dataset$adjMeasles)
summary(p)

new_clean$crootThinness <- (new_clean$Thinness)^(1/3)
constant_value <- 0.0001
new_clean$adjMeasles <- new_clean$Measles + constant_value
new_clean$lnMeasles <- log(new_clean$adjMeasles+1)
model3 <- lm(crootThinness ~ Hepatitis_B + lnMeasles + Healthcare_Expenditure + Status_name + Schooling, data = new_clean)
model3

hist(new_clean$crootThinness, main="Histogram", xlab="sqrt(Thinness)")
y_hat <- fitted(model3)
e_hat <- resid(model3)
plot(x = y_hat, y = e_hat, main="Residual vs Fitted", xlab="Fitted",
     ylab="Residuals")
plot(e_hat ~ new_clean$Hepatitis_B, main="Residuals vs Hepatitis B", xlab="Hepatitis B", ylab="Residual")
plot(e_hat ~ new_clean$lnMeasles, main="Residuals vs ln(Measles)", xlab="Measles", ylab="Residual")
plot(e_hat ~ new_clean$Healthcare_Expenditure, main="Residuals vs Healthcare Expenditure", xlab="Healthcare Expenditure", ylab="Residual")
boxplot(e_hat ~ new_clean$Status_name, main="Residuals vs Status Name", xlab="Status Name", ylab="Residual")
plot(e_hat ~ new_clean$Schooling, main="Residuals vs Schooling", xlab="Schooling", ylab="Residual")
qqnorm(e_hat)
qqline(e_hat)
plot(x = y_hat, y = model3$crootThinness, main="Response vs Fitted",
     xlab="Fitted", ylab="croot(Thinness)")
abline(a = 0, b = 1, lty=2)

```

```{r}
#install.packages("MASS")
library(MASS)
stepAIC(lm(Dataset$crootThinness ~ 1, data=Dataset[,-1]),scope=list(upper=lm(Dataset$crootThinness ~ ., data=Dataset[,-1])), direction = "both", k=5)

```

```{r}
#install.packages("leaps")
library(leaps)

best <- regsubsets(Dataset$crootThinness ~ Hepatitis_B + Dataset$lnMeasles + Healthcare_Expenditure + Status_name + Schooling, data = new_clean, nbest = 1, nvmax=5)
summary(best)

library(car)
subsets(best, statistic = "adjr2", legend=TRUE)

```

Results section: 
```{r}
confint(model4)
#predict(model4, newdata = new, interval="prediction", level=0.95)
```
Discussion section: 

Ethics discussion:
```{r}

```
